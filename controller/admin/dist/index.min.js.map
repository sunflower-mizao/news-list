{"version":3,"sources":["index.js"],"names":["adminModel","require","module","exports","ctx","p","perPage","newsData","totalCount","pCount","regeneratorRuntime","async","_context","prev","next","parseInt","query","awrap","getData","sent","getTotal","Math","ceil","render","stop","addData","res","info","_context2","request","affectedRows","status","body","deleteData","id","resData","_context3"],"mappings":"aAAA,IAAMA,WAAaC,QAAQ,uBAC3BC,OAAOC,QAAU,CADXH,MACW,SADDI,GACC,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAC,mBAAAC,MAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAE,MAAA,KAAA,EAAA,OAAVX,EAAPY,SAAiBX,EAAAY,MAAAX,IAAA,EAAAC,EAAA,EAAAM,EAAAE,KAAA,EAAAJ,mBAAAO,MAAAjB,WAAAkB,QAAAb,EAAAC,IAAA,KAAA,EAAA,OAAAC,EAAAK,EAAAO,KAAAP,EAAAE,KAAA,EAAAJ,mBAAAO,MAAAjB,WAAAoB,YAAA,KAAA,EAAA,OAAAZ,EAAAI,EAAAO,KAAAV,EAAAY,KAAAC,KAAAd,EAAAF,GAAAM,EAAAE,KAAA,GAAAJ,mBAAAO,MAAAb,EAAAmB,OAAA,oBAAA,CAAAhB,SAAAA,EAETE,OAAAA,EACIJ,EAAAA,KAHK,KAAA,GAAA,IAAA,MAAA,OAAAO,EAAAY,WAePC,QAfO,SAeCrB,GAfD,IAAAsB,EAAAC,EAAA,OAAAjB,mBAAAC,MAAA,SAAAiB,GAAA,OAAA,OAAAA,EAAAf,KAAAe,EAAAd,MAAA,KAAA,EAAA,OAAAc,EAAAd,KAAA,EAAAJ,mBAAAO,MAAAjB,WAAAyB,QAAArB,EAAAyB,UAAA,KAAA,EAAAH,EAAAE,EAAAT,KAAAQ,EAoBW,EAAjBD,EAAII,aApBE,CAMLtB,KAAAA,OACAC,OAASY,GAETd,CACAE,KAAM,OACLsB,OAAD1B,GAXKD,EAAA4B,KAAAL,EAAA,KAAA,EAAA,IAAA,MAAA,OAAAC,EAAAJ,WAAAS,WAAA,SAAA7B,GAAA,IAAA8B,EAAAC,EAAA,OAAAzB,mBAAAC,MAAA,SAAAyB,GAAA,OAAA,OAAAA,EAAAvB,KAAAuB,EAAAtB,MAAA,KAAA,EAAA,OAAAoB,EAAAnB,SAAAX,EAAAY,MAAAkB,KAAA,EAAAE,EAAAtB,KAAA,EAAAJ,mBAAAO,MAAAjB,WAAAiC,WAAAC,IAAA,KAAA,EAAA,EAAAE,EAAAjB,KAAAW,aAAAK,EAAA,CAAAR,KAAA,OAAAI,OAAA,GAAAJ,KAAA,CA8CDA,KAAK,OA9CJI,OAAA,GAqBLJ,EAAAA,KAAIQ,EArBC,KAAA,EAAA,IAAA,MAAA,OAAAC,EAAAZ","file":"index.min.js","sourcesContent":["const adminModel = require(\"../../service/admin\")\r\nmodule.exports = {\r\n    async index(ctx){\r\n        // ctx.body = \"admin的主页\";\r\n        let p = parseInt(ctx.query.p) || 1;\r\n        let perPage = 5;\r\n        let newsData = await adminModel.getData(p,perPage);\r\n        let totalCount = await adminModel.getTotal();\r\n        let pCount = Math.ceil(totalCount / perPage);\r\n        await ctx.render(\"./admin/admin.pug\",{\r\n            newsData,\r\n            pCount,\r\n            p\r\n        })\r\n        // await ctx.render(\"./admin/admin.pug\");\r\n    },\r\n    async addData(ctx){\r\n        // console.log(ctx.request.body);\r\n        // console.log(ctx.request.files);\r\n        let res = await adminModel.addData(ctx.request);\r\n        let info;\r\n        if(res.affectedRows>0){\r\n            info = {\r\n                info:\"操作成功\",\r\n                status:1\r\n            }\r\n        }else{\r\n            info = {\r\n                info:\"操作失败\",\r\n                status:0\r\n            }\r\n        }\r\n        ctx.body = info;\r\n        // await ctx.render(\"./admin/admin.pug\");\r\n    },\r\n    async deleteData(ctx){\r\n        let id = parseInt(ctx.query.id) || 1;\r\n        let rows = await adminModel.deleteData(id);\r\n        // console.log(rows);\r\n        let resData;\r\n        if(rows.affectedRows>0){\r\n            resData = {\r\n                info:\"删除成功\",\r\n                status:1\r\n            }\r\n        }else{\r\n            info = {\r\n                info:\"删除失败\",\r\n                status:0\r\n            }\r\n            \r\n        }\r\n        ctx.body = resData;\r\n    }\r\n}"]}