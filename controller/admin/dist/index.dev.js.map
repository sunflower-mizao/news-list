{"version":3,"sources":["index.js"],"names":["adminModel","require","module","exports","index","ctx","p","parseInt","query","perPage","getData","newsData","getTotal","totalCount","pCount","Math","ceil","render","addData","request","res","affectedRows","info","status","body","deleteData","id","rows","resData"],"mappings":";;AAAA,IAAMA,UAAU,GAAGC,OAAO,CAAC,qBAAD,CAA1B;;AACAC,MAAM,CAACC,OAAP,GAAiB;AACPC,EAAAA,KADO,iBACDC,GADC;AAAA;AAAA;AAAA;AAAA;AAAA;AAET;AACIC,YAAAA,CAHK,GAGDC,QAAQ,CAACF,GAAG,CAACG,KAAJ,CAAUF,CAAX,CAAR,IAAyB,CAHxB;AAILG,YAAAA,OAJK,GAIK,CAJL;AAAA;AAAA,4CAKYT,UAAU,CAACU,OAAX,CAAmBJ,CAAnB,EAAqBG,OAArB,CALZ;;AAAA;AAKLE,YAAAA,QALK;AAAA;AAAA,4CAMcX,UAAU,CAACY,QAAX,EANd;;AAAA;AAMLC,YAAAA,UANK;AAOLC,YAAAA,MAPK,GAOIC,IAAI,CAACC,IAAL,CAAUH,UAAU,GAAGJ,OAAvB,CAPJ;AAAA;AAAA,4CAQHJ,GAAG,CAACY,MAAJ,CAAW,mBAAX,EAA+B;AACjCN,cAAAA,QAAQ,EAARA,QADiC;AAEjCG,cAAAA,MAAM,EAANA,MAFiC;AAGjCR,cAAAA,CAAC,EAADA;AAHiC,aAA/B,CARG;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAePY,EAAAA,OAfO,mBAeCb,GAfD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CAkBOL,UAAU,CAACkB,OAAX,CAAmBb,GAAG,CAACc,OAAvB,CAlBP;;AAAA;AAkBLC,YAAAA,GAlBK;;AAoBT,gBAAGA,GAAG,CAACC,YAAJ,GAAiB,CAApB,EAAsB;AAClBC,cAAAA,IAAI,GAAG;AACHA,gBAAAA,IAAI,EAAC,MADF;AAEHC,gBAAAA,MAAM,EAAC;AAFJ,eAAP;AAIH,aALD,MAKK;AACDD,cAAAA,IAAI,GAAG;AACHA,gBAAAA,IAAI,EAAC,MADF;AAEHC,gBAAAA,MAAM,EAAC;AAFJ,eAAP;AAIH;;AACDlB,YAAAA,GAAG,CAACmB,IAAJ,GAAWF,IAAX,CA/BS,CAgCT;;AAhCS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkCPG,EAAAA,UAlCO,sBAkCIpB,GAlCJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAmCLqB,YAAAA,EAnCK,GAmCAnB,QAAQ,CAACF,GAAG,CAACG,KAAJ,CAAUkB,EAAX,CAAR,IAA0B,CAnC1B;AAAA;AAAA,4CAoCQ1B,UAAU,CAACyB,UAAX,CAAsBC,EAAtB,CApCR;;AAAA;AAoCLC,YAAAA,IApCK;;AAuCT,gBAAGA,IAAI,CAACN,YAAL,GAAkB,CAArB,EAAuB;AACnBO,cAAAA,OAAO,GAAG;AACNN,gBAAAA,IAAI,EAAC,MADC;AAENC,gBAAAA,MAAM,EAAC;AAFD,eAAV;AAIH,aALD,MAKK;AACDD,cAAAA,IAAI,GAAG;AACHA,gBAAAA,IAAI,EAAC,MADF;AAEHC,gBAAAA,MAAM,EAAC;AAFJ,eAAP;AAKH;;AACDlB,YAAAA,GAAG,CAACmB,IAAJ,GAAWI,OAAX;;AAnDS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAjB","sourcesContent":["const adminModel = require(\"../../service/admin\")\r\nmodule.exports = {\r\n    async index(ctx){\r\n        // ctx.body = \"admin的主页\";\r\n        let p = parseInt(ctx.query.p) || 1;\r\n        let perPage = 5;\r\n        let newsData = await adminModel.getData(p,perPage);\r\n        let totalCount = await adminModel.getTotal();\r\n        let pCount = Math.ceil(totalCount / perPage);\r\n        await ctx.render(\"./admin/admin.pug\",{\r\n            newsData,\r\n            pCount,\r\n            p\r\n        })\r\n        // await ctx.render(\"./admin/admin.pug\");\r\n    },\r\n    async addData(ctx){\r\n        // console.log(ctx.request.body);\r\n        // console.log(ctx.request.files);\r\n        let res = await adminModel.addData(ctx.request);\r\n        let info;\r\n        if(res.affectedRows>0){\r\n            info = {\r\n                info:\"操作成功\",\r\n                status:1\r\n            }\r\n        }else{\r\n            info = {\r\n                info:\"操作失败\",\r\n                status:0\r\n            }\r\n        }\r\n        ctx.body = info;\r\n        // await ctx.render(\"./admin/admin.pug\");\r\n    },\r\n    async deleteData(ctx){\r\n        let id = parseInt(ctx.query.id) || 1;\r\n        let rows = await adminModel.deleteData(id);\r\n        // console.log(rows);\r\n        let resData;\r\n        if(rows.affectedRows>0){\r\n            resData = {\r\n                info:\"删除成功\",\r\n                status:1\r\n            }\r\n        }else{\r\n            info = {\r\n                info:\"删除失败\",\r\n                status:0\r\n            }\r\n            \r\n        }\r\n        ctx.body = resData;\r\n    }\r\n}"],"file":"index.dev.js"}